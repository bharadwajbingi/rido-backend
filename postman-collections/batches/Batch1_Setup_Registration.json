{
  "info": {
    "_postman_id": "rido-batch-1",
    "name": "Rido Tests - Batch1_Setup_Registration",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    },
    {
      "key": "admin_url",
      "value": "http://localhost:9091"
    },
    {
      "key": "token",
      "value": ""
    },
    {
      "key": "refresh_token",
      "value": ""
    },
    {
      "key": "admin_token",
      "value": ""
    },
    {
      "key": "user_id",
      "value": ""
    },
    {
      "key": "test_user",
      "value": ""
    },
    {
      "key": "test_pass",
      "value": "TestPass123!"
    },
    {
      "key": "session_id",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "00-Setup",
      "item": [
        {
          "name": "Admin Health",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200', ()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Login",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"admin\",\"password\":\"adminpass\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if(pm.response.code===200){pm.collectionVariables.set('admin_token',pm.response.json().accessToken);}pm.test('OK',()=>true);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "01-Registration (25 tests)",
      "item": [
        {
          "name": "[+] Valid Registration",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "pm.collectionVariables.set('test_user','u'+Date.now());"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Username 1 char",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"a\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Username 2 chars",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"ab\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Username 3 chars (min)",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"u3_1764838059622\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Password 5 chars",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"12345\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Password 6 chars (min)",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"p6_1764838059622\",\"password\":\"123456\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Duplicate username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('409',()=>pm.response.to.have.status(409));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL injection username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"admin'--\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS in username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<script>alert(1)</script>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null byte in username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\\u0000user\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Unicode username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"用户名\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|200',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Special chars username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test@#$%\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Whitespace username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"   \",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Username with spaces",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test user\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Very long username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Invalid JSON body",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Array instead of object",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "[]"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null body",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Wrong content type",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/plain"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"pass\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] No content type",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"pass\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Extra fields ignored",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"extra_1764838059622\",\"password\":\"Test123!\",\"role\":\"ADMIN\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}