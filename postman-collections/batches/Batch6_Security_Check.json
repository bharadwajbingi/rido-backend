{
  "info": {
    "_postman_id": "rido-batch-6",
    "name": "Rido Tests - Batch6_Security_Check",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    },
    {
      "key": "admin_url",
      "value": "http://localhost:9091"
    },
    {
      "key": "token",
      "value": ""
    },
    {
      "key": "refresh_token",
      "value": ""
    },
    {
      "key": "admin_token",
      "value": ""
    },
    {
      "key": "user_id",
      "value": ""
    },
    {
      "key": "test_user",
      "value": ""
    },
    {
      "key": "test_pass",
      "value": "TestPass123!"
    },
    {
      "key": "session_id",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "08-Security (30 tests)",
      "item": [
        {
          "name": "[-] Gateway blocks admin",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Gateway blocks admin/login",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/admin/login",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Gateway blocks admin/create",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/admin/create",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Gateway blocks admin/audit",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/admin/audit/logs",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Path traversal 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/../admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404|400',()=>pm.expect([400,404]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Path traversal 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/../../admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404|400',()=>pm.expect([400,404]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL in login user",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"1' OR '1'='1\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|400',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL in login pass",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"' OR '1'='1\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] UNION attack",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"' UNION SELECT * FROM users--\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|400',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS script tag",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<script>alert(1)</script>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS img tag",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<img src=x onerror=alert(1)>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS svg tag",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<svg onload=alert(1)>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Header injection 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "X-Forwarded-For",
                "value": "127.0.0.1"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|401',()=>pm.expect([200,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Header injection 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "X-User-ID",
                "value": "admin"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|401',()=>pm.expect([200,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Host header attack",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": [
              {
                "key": "Host",
                "value": "evil.com"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|400',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Method not allowed PUT",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Method not allowed DELETE",
          "request": {
            "method": "DELETE",
            "url": "{{base_url}}/auth/login",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Method not allowed PATCH",
          "request": {
            "method": "PATCH",
            "url": "{{base_url}}/auth/login",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Content type xml",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/xml"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XXE attempt",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/xml"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe1",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe2",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 3",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe3",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 4",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe4",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 5",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe5",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 6",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe6",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 7",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe7",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 8",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe8",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 9",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe9",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 10",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe10",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "09-Check Username (10 tests)",
      "item": [
        {
          "name": "[+] Check available",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=available_1764838059623",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Check taken",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username={{test_user}}",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check no param",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check empty",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check too short",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=ab",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check SQL injection",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=admin'--",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|200',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check special chars",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=test@#$",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Check unicode",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=用户",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|400',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check very long",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] POST not allowed",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/check-username",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}