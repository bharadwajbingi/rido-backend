{
  "info": {
    "_postman_id": "rido-200-tests",
    "name": "Rido API - 200+ Comprehensive Test Suite",
    "description": "200+ test cases covering security, edge cases, validation, and stress testing",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    },
    {
      "key": "admin_url",
      "value": "http://localhost:9091"
    },
    {
      "key": "token",
      "value": ""
    },
    {
      "key": "refresh_token",
      "value": ""
    },
    {
      "key": "admin_token",
      "value": ""
    },
    {
      "key": "user_id",
      "value": ""
    },
    {
      "key": "test_user",
      "value": ""
    },
    {
      "key": "test_pass",
      "value": "TestPass123!"
    },
    {
      "key": "session_id",
      "value": ""
    }
  ],
  "item": [
    {
      "name": "00-Setup",
      "item": [
        {
          "name": "Admin Health",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200', ()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Login",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"admin\",\"password\":\"adminpass\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if(pm.response.code===200){pm.collectionVariables.set('admin_token',pm.response.json().accessToken);}pm.test('OK',()=>true);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "01-Registration (25 tests)",
      "item": [
        {
          "name": "[+] Valid Registration",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "pm.collectionVariables.set('test_user','u'+Date.now());"
                ]
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Username 1 char",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"a\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Username 2 chars",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"ab\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Username 3 chars (min)",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"u3_1764838059622\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Password 5 chars",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"12345\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Password 6 chars (min)",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"p6_1764838059622\",\"password\":\"123456\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Duplicate username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('409',()=>pm.response.to.have.status(409));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL injection username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"admin'--\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS in username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<script>alert(1)</script>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null byte in username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\\u0000user\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Unicode username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"用户名\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|200',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Special chars username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test@#$%\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Whitespace username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"   \",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Username with spaces",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test user\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Very long username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Invalid JSON body",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Array instead of object",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "[]"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null body",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Wrong content type",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "text/plain"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"pass\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] No content type",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"pass\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Extra fields ignored",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"extra_1764838059622\",\"password\":\"Test123!\",\"role\":\"ADMIN\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "02-Login (25 tests)",
      "item": [
        {
          "name": "[+] Valid login",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Device-Id",
                "value": "test"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));var j=pm.response.json();pm.collectionVariables.set('token',j.accessToken);pm.collectionVariables.set('refresh_token',j.refreshToken);"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Wrong password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"wrong\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Non-existent user",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"nonexistent_xyz\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|423',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty body",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL injection",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"' OR 1=1--\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|400',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS attack",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<img src=x onerror=alert(1)>\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|400',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Login with device ID",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Device-Id",
                "value": "device-123"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":null,\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":null}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Number as username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":12345,\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|401',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Boolean as password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":true}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Array as username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":[\"admin\"],\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Object as password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":{\"val\":\"test\"}}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Very long password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|401',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Unicode password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"密码测试\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Leading spaces username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"  test\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Trailing spaces username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test  \",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Case sensitive username",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{TEST_USER}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|200',()=>pm.expect([200,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Case sensitive password",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"testpass123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Login response has token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasToken',()=>pm.expect(pm.response.json().accessToken).to.be.a('string'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Login response has refresh",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasRefresh',()=>pm.expect(pm.response.json().refreshToken).to.be.a('string'));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "03-Protected Endpoints (30 tests)",
      "item": [
        {
          "name": "[+] GET /auth/me",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));pm.collectionVariables.set('user_id',pm.response.json().id);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] /me has id",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasId',()=>pm.expect(pm.response.json().id).to.be.a('string'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] /me has username",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasUsername',()=>pm.expect(pm.response.json().username).to.be.a('string'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /me no auth",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /me invalid token",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer invalid"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /me malformed token",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer eyJ.fake"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /me empty bearer",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer "
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /me no bearer prefix",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "{{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /me basic auth",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Basic dGVzdDp0ZXN0"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] GET /auth/sessions",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));pm.test('isArray',()=>pm.expect(pm.response.json()).to.be.an('array'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Sessions no auth",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] GET /secure/info",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/secure/info",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] /secure/info no auth",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/secure/info",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Tampered signature",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIxMjMifQ.tampered"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Wrong algorithm",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer eyJhbGciOiJub25lIn0.eyJzdWIiOiIxMjMifQ."
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing kid",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIxIn0.sig"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken1"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken2"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 3",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken3"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 4",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken4"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 5",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken5"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 6",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken6"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 7",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken7"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 8",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken8"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 9",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken9"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 10",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken10"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 11",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken11"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 12",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken12"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 13",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken13"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid token 14",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer randomtoken14"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "04-Refresh Token (20 tests)",
      "item": [
        {
          "name": "[+] Valid refresh",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Device-Id",
                "value": "test"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"{{refresh_token}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));var j=pm.response.json();pm.collectionVariables.set('token',j.accessToken);if(j.refreshToken)pm.collectionVariables.set('refresh_token',j.refreshToken);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Refresh has new token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Device-Id",
                "value": "test"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"{{refresh_token}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasToken',()=>pm.expect(pm.response.json().accessToken).to.be.a('string'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Missing refresh token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Invalid refresh token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalid\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Null refresh token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":null}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Empty refresh token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Number as token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":12345}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Array as token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":[\"token\"]}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Object as token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":{\"val\":\"token\"}}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 1",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken1\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 2",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken2\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 3",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken3\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 4",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken4\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 5",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken5\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 6",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken6\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 7",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken7\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 8",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken8\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 9",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken9\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 10",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken10\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Random invalid refresh 11",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/refresh",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalidtoken11\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "05-JWKS (10 tests)",
      "item": [
        {
          "name": "[+] GET /auth/keys/jwks.json",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] JWKS has keys array",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasKeys',()=>pm.expect(pm.response.json().keys).to.be.an('array'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Key has kty",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasKty',()=>pm.expect(pm.response.json().keys[0].kty).to.exist);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Key has kid",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasKid',()=>pm.expect(pm.response.json().keys[0].kid).to.exist);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Key has alg",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasAlg',()=>pm.expect(pm.response.json().keys[0].alg).to.exist);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] GET well-known",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/.well-known/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] POST not allowed",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] PUT not allowed",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] DELETE not allowed",
          "request": {
            "method": "DELETE",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] PATCH not allowed",
          "request": {
            "method": "PATCH",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "06-Logout (15 tests)",
      "item": [
        {
          "name": "[+] Re-login for logout",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var j=pm.response.json();pm.collectionVariables.set('token',j.accessToken);pm.collectionVariables.set('refresh_token',j.refreshToken);pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Valid logout",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"{{refresh_token}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout no refresh token",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout invalid refresh",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"invalid\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout empty refresh",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 1",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_1\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 2",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_2\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 3",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_3\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 4",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_4\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 5",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_5\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 6",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_6\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 7",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_7\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 8",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_8\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 9",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_9\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Logout random token 10",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/logout",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"refreshToken\":\"logout_invalid_10\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "07-Admin (25 tests)",
      "item": [
        {
          "name": "[+] Admin health",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Health has status",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('hasStatus',()=>pm.expect(pm.response.json().status).to.exist);"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin login wrong pass",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"admin\",\"password\":\"wrong\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin login empty",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin login missing user",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin login missing pass",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"admin\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[~] Audit logs (skip if no token)",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs?page=0&size=10",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if(!pm.collectionVariables.get('admin_token')){pm.test('skip',()=>true);return;}pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Audit no auth",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|403',()=>pm.expect([401,403]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Audit invalid token",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer invalid"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[~] Create admin (skip)",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/create",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"newadmin_1764838059623\",\"password\":\"Admin123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if(!pm.collectionVariables.get('admin_token')){pm.test('skip',()=>true);return;}pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Create no auth",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/create",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"Admin123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Create invalid token",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/create",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer invalid"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"Admin123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[~] Key rotate (skip)",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/key/rotate",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{admin_token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if(!pm.collectionVariables.get('admin_token')){pm.test('skip',()=>true);return;}pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Rotate no auth",
          "request": {
            "method": "POST",
            "url": "{{admin_url}}/admin/key/rotate",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 1",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_1"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 2",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_2"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 3",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_3"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 4",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_4"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 5",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_5"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 6",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_6"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 7",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_7"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 8",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_8"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 9",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_9"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 10",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_10"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Admin random token 11",
          "request": {
            "method": "GET",
            "url": "{{admin_url}}/admin/audit/logs",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer admin_invalid_11"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "08-Security (30 tests)",
      "item": [
        {
          "name": "[-] Gateway blocks admin",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Gateway blocks admin/login",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/admin/login",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Gateway blocks admin/create",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/admin/create",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Gateway blocks admin/audit",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/admin/audit/logs",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Path traversal 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/../admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404|400',()=>pm.expect([400,404]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Path traversal 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/../../admin/health",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404|400',()=>pm.expect([400,404]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL in login user",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"1' OR '1'='1\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|400',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] SQL in login pass",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"test\",\"password\":\"' OR '1'='1\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] UNION attack",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"' UNION SELECT * FROM users--\",\"password\":\"test\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401|400',()=>pm.expect([400,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS script tag",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<script>alert(1)</script>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS img tag",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<img src=x onerror=alert(1)>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XSS svg tag",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/register",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"<svg onload=alert(1)>\",\"password\":\"Test123!\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Header injection 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "X-Forwarded-For",
                "value": "127.0.0.1"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|401',()=>pm.expect([200,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Header injection 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/me",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "X-User-ID",
                "value": "admin"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|401',()=>pm.expect([200,401]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Host header attack",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/keys/jwks.json",
            "header": [
              {
                "key": "Host",
                "value": "evil.com"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|400',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Method not allowed PUT",
          "request": {
            "method": "PUT",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Method not allowed DELETE",
          "request": {
            "method": "DELETE",
            "url": "{{base_url}}/auth/login",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Method not allowed PATCH",
          "request": {
            "method": "PATCH",
            "url": "{{base_url}}/auth/login",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Content type xml",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/xml"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] XXE attempt",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/xml"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('415|400',()=>pm.expect([400,415]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe1",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe2",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 3",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe3",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 4",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe4",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 5",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe5",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 6",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe6",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 7",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe7",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 8",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe8",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 9",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe9",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Security probe 10",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/probe10",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('404',()=>pm.response.to.have.status(404));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "09-Check Username (10 tests)",
      "item": [
        {
          "name": "[+] Check available",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=available_1764838059623",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Check taken",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username={{test_user}}",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check no param",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check empty",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check too short",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=ab",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check SQL injection",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=admin'--",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|200',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check special chars",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=test@#$",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Check unicode",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=用户",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|400',()=>pm.expect([200,400]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Check very long",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/check-username?username=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400',()=>pm.expect([400,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] POST not allowed",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/check-username",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('405',()=>pm.expect([405,500]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "10-Sessions (15 tests)",
      "item": [
        {
          "name": "[+] Re-login for sessions",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Device-Id",
                "value": "session-test"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var j=pm.response.json();pm.collectionVariables.set('token',j.accessToken);pm.collectionVariables.set('refresh_token',j.refreshToken);pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] List sessions",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));var s=pm.response.json();if(s.length>0)pm.collectionVariables.set('session_id',s[0].id);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Sessions is array",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('isArray',()=>pm.expect(pm.response.json()).to.be.an('array'));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Sessions no auth",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Sessions invalid token",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer invalid"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Revoke all sessions",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/sessions/revoke-all",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Revoke all no auth",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/sessions/revoke-all",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Re-login after revoke",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/login",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Device-Id",
                "value": "new-session"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\"username\":\"{{test_user}}\",\"password\":\"{{test_pass}}\"}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var j=pm.response.json();pm.collectionVariables.set('token',j.accessToken);pm.test('200',()=>pm.response.to.have.status(200));"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Get new sessions",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200',()=>pm.response.to.have.status(200));var s=pm.response.json();if(s.length>0)pm.collectionVariables.set('session_id',s[0].id);"
                ]
              }
            }
          ]
        },
        {
          "name": "[+] Revoke single session",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/sessions/{{session_id}}/revoke",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('200|404',()=>pm.expect([200,404]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Revoke invalid session",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/sessions/invalid-id/revoke",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('400|404',()=>pm.expect([400,404]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Revoke no auth",
          "request": {
            "method": "POST",
            "url": "{{base_url}}/auth/sessions/{{session_id}}/revoke",
            "header": []
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Session random 1",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer session_invalid_1"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Session random 2",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer session_invalid_2"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        },
        {
          "name": "[-] Session random 3",
          "request": {
            "method": "GET",
            "url": "{{base_url}}/auth/sessions",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer session_invalid_3"
              }
            ]
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('401',()=>pm.expect([401,423]).to.include(pm.response.code));"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}