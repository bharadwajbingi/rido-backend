{
  "info": {
    "_postman_id": "99da14be-8859-4419-9300-fc443cd92be8",
    "name": "02 - Login Tests",
    "description": "Comprehensive login endpoint testing including security and rate limiting",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "\ud83d\udccb Setup - Register Test User",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/register",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"{{test_password}}\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('User Created', () => pm.expect(pm.response.code).to.be.oneOf([200, 409]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u2705 Valid Login",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"{{test_password}}\"\n}"
        },
        "description": "Successful login with valid credentials"
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 1000);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Success', () => pm.response.to.have.status(200));",
              "const resp = pm.response.json();",
              "pm.test('Has accessToken', () => pm.expect(resp.accessToken).to.exist);",
              "pm.test('Has refreshToken', () => pm.expect(resp.refreshToken).to.exist);",
              "pm.environment.set('access_token', resp.accessToken);",
              "pm.environment.set('refresh_token', resp.refreshToken);"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Wrong Password",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"WrongPassword123\"\n}"
        },
        "description": "Login attempt with incorrect password"
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Failed', () => pm.response.to.have.status(401));",
              "pm.test('Error Message', () => pm.expect(pm.response.json().error).to.exist);"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Wrong Username",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"nonexistentuser\",\n    \"password\": \"{{test_password}}\"\n}"
        },
        "description": "Login attempt with non-existent username"
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Failed', () => pm.response.to.have.status(401));",
              "pm.test('Error Message', () => pm.expect(pm.response.json().error).to.exist);"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udccb Setup - Create Lockout User",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/register",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"lockoutuser_{{$guid}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('User Created', () => pm.expect(pm.response.code).to.be.oneOf([200, 409]));",
              "var reqBody = JSON.parse(pm.request.body.raw);",
              "pm.environment.set('lockout_user', reqBody.username);"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Failed Login Attempt #1",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{lockout_user}}\",\n    \"password\": \"WrongPassword\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #1 Failed', () => pm.expect(pm.response.code).to.be.oneOf([401, 423]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Failed Login Attempt #2",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{lockout_user}}\",\n    \"password\": \"WrongPassword\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #2 Failed', () => pm.expect(pm.response.code).to.be.oneOf([401, 423]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Failed Login Attempt #3",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{lockout_user}}\",\n    \"password\": \"WrongPassword\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #3 Failed', () => pm.expect(pm.response.code).to.be.oneOf([401, 423]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Failed Login Attempt #4",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{lockout_user}}\",\n    \"password\": \"WrongPassword\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #4 Failed', () => pm.expect(pm.response.code).to.be.oneOf([401, 423]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Failed Login Attempt #5",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{lockout_user}}\",\n    \"password\": \"WrongPassword\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 500);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #5 Failed', () => pm.expect(pm.response.code).to.be.oneOf([401, 423]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udd12 Account Locked",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{lockout_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        },
        "description": "Verify account locks after 5 failed attempts"
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 1000);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Account Locked', () => pm.response.to.have.status(423));",
              "pm.test('Locked Message', () => pm.expect(pm.response.json().error).to.include('locked'));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udccb Rate Limit - Create Test User",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/register",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"ratelimituser_{{$guid}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('User Created', () => pm.expect(pm.response.code).to.be.oneOf([200, 409]));",
              "var reqBody = JSON.parse(pm.request.body.raw);",
              "pm.environment.set('ratelimit_user', reqBody.username);"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #1",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #1', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #2",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #2', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #3",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #3', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #4",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #4', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #5",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #5', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #6",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #6', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u23f1\ufe0f Rapid Login Attempt #7",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{ratelimit_user}}\",\n    \"password\": \"SecurePass123!\"\n}"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 100);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Attempt #7', () => pm.expect(pm.response.code).to.be.oneOf([200, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Missing Device-ID",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"{{test_password}}\"\n}"
        },
        "description": "Login with missing device-id"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Response', () => pm.expect(pm.response.code).to.be.oneOf([200, 400]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Empty Device-ID",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-Device-ID",
            "value": ""
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"{{test_password}}\"\n}"
        },
        "description": "Login with empty device-id"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Response', () => pm.expect(pm.response.code).to.be.oneOf([200, 400]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Invalid Format Device-ID",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-Device-ID",
            "value": "not-a-uuid"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"{{test_password}}\"\n}"
        },
        "description": "Login with invalid format device-id"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Response', () => pm.expect(pm.response.code).to.be.oneOf([200, 400]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c SQL Injection Device-ID",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-Device-ID",
            "value": "'; DROP TABLE--"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"{{test_user}}\",\n    \"password\": \"{{test_password}}\"\n}"
        },
        "description": "Login with sql injection device-id"
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Login Response', () => pm.expect(pm.response.code).to.be.oneOf([200, 400]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Incomplete JSON",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\"username\": \"test\""
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Malformed JSON Rejected', () => pm.expect(pm.response.code).to.be.oneOf([400, 500]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Invalid JSON Syntax",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\"username\": \"test\",}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Malformed JSON Rejected', () => pm.expect(pm.response.code).to.be.oneOf([400, 500]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Array Instead of Object",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "[]"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Malformed JSON Rejected', () => pm.expect(pm.response.code).to.be.oneOf([400, 500]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c String Instead of Object",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "\"just a string\""
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Malformed JSON Rejected', () => pm.expect(pm.response.code).to.be.oneOf([400, 500]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Number Instead of Object",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "12345"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Malformed JSON Rejected', () => pm.expect(pm.response.code).to.be.oneOf([400, 500]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #1",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"admin' OR '1'='1\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: admin' OR '1'='1..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #2",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"'; DROP TABLE users; --\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: '; DROP TABLE users; --..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #3",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"admin'--\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: admin'--..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #4",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"1' UNION SELECT NULL--\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: 1' UNION SELECT NULL--..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #5",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"' OR 1=1--\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: ' OR 1=1--..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #6",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"admin' AND '1'='1\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: admin' AND '1'='1..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f SQLi Login #7",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"admin' /*\",\n    \"password\": \"anything\"\n}"
        },
        "description": "SQL injection via username: admin' /*..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('SQL Injection Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f XSS Login #1",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"<script>alert('xss')</script>\",\n    \"password\": \"anything\"\n}"
        },
        "description": "XSS via username: <script>alert('xss')</script>..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('XSS Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f XSS Login #2",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"<img src=x onerror=alert(1)>\",\n    \"password\": \"anything\"\n}"
        },
        "description": "XSS via username: <img src=x onerror=alert(1)>..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('XSS Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f XSS Login #3",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"javascript:alert(1)\",\n    \"password\": \"anything\"\n}"
        },
        "description": "XSS via username: javascript:alert(1)..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('XSS Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f XSS Login #4",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"<svg onload=alert(1)>\",\n    \"password\": \"anything\"\n}"
        },
        "description": "XSS via username: <svg onload=alert(1)>..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('XSS Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\ud83d\udee1\ufe0f XSS Login #5",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"'\\\"><script>alert('xss')</script>\",\n    \"password\": \"anything\"\n}"
        },
        "description": "XSS via username: '\"><script>alert('xss')</scrip..."
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "setTimeout(() => {}, 300);"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('XSS Blocked', () => pm.expect(pm.response.code).to.be.oneOf([400, 401, 423, 429]));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Missing Username",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"password\": \"password\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Missing Password",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"username\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Empty Username",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"\",\n    \"password\": \"password\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Empty Password",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"username\",\n    \"password\": \"\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Null Username",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": null,\n    \"password\": \"password\"\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Null Password",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"username\",\n    \"password\": null\n}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    },
    {
      "name": "\u274c Empty Body",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "url": "{{base_url}}/auth/login",
        "body": {
          "mode": "raw",
          "raw": "{}"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Missing Field Rejected', () => pm.response.to.have.status(400));"
            ]
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    },
    {
      "key": "test_user",
      "value": "logintest_fff3ae84"
    },
    {
      "key": "test_password",
      "value": "SecurePass123!"
    },
    {
      "key": "access_token",
      "value": ""
    },
    {
      "key": "refresh_token",
      "value": ""
    }
  ]
}